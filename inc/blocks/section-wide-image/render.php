{
  "content": "<?php\n/**\n * Section Wide Image Block Template\n * \n * @param array $attributes Block attributes\n * @param string $content Block content\n * @param WP_Block $block Block object\n */\n\n// Prevent direct access\nif (!defined('ABSPATH')) {\n    exit;\n}\n\n// Extract attributes with defaults and apply security filters\n$image_url = $attributes['imageUrl'] ?? 'https://images.unsplash.com/photo-1575936123452-b67c3203c357?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w4MTAzMDV8MHwxfHNlYXJjaHwxfHxpbWFnZXxlbnwwfDB8fHwxNzU5NjYzODYwfDA&ixlib=rb-4.1.0&q=80&w=1920';\n$image_id = $attributes['imageId'] ?? 0;\n$image_alt = $attributes['imageAlt'] ?? 'Collaborative workspace with laptops, tablets, notebooks and coffee on wooden table';\n$image_width = $attributes['imageWidth'] ?? 1920;\n$image_height = $attributes['imageHeight'] ?? 800;\n$object_fit = $attributes['objectFit'] ?? 'cover';\n$border_radius = $attributes['borderRadius'] ?? '2xl';\n$enable_animation = $attributes['enableAnimation'] ?? true;\n$animation_type = $attributes['animationType'] ?? 'fade-up';\n$animation_duration = $attributes['animationDuration'] ?? 1200;\n$animation_delay = $attributes['animationDelay'] ?? 0;\n$animation_easing = $attributes['animationEasing'] ?? 'ease-in-out';\n$aspect_ratio = $attributes['aspectRatio'] ?? 'auto';\n$max_height = $attributes['maxHeight'] ?? 'none';\n$overlay_enabled = $attributes['overlayEnabled'] ?? false;\n$overlay_color = $attributes['overlayColor'] ?? 'rgba(0, 0, 0, 0.3)';\n$overlay_opacity = $attributes['overlayOpacity'] ?? 30;\n$link_url = $attributes['linkUrl'] ?? '';\n$link_target = $attributes['linkTarget'] ?? '';\n$link_rel = $attributes['linkRel'] ?? '';\n$enable_lazy_load = $attributes['enableLazyLoad'] ?? true;\n$container_padding = $attributes['containerPadding'] ?? 'none';\n\n// Helper functions scoped to this template (avoid global namespace pollution)\n$get_border_radius_class = function($radius) {\n    $radius_map = [\n        'none' => 'rounded-none',\n        'sm' => 'rounded-sm',\n        'md' => 'rounded-md',\n        'lg' => 'rounded-lg',\n        'xl' => 'rounded-xl',\n        '2xl' => 'rounded-2xl',\n        '3xl' => 'rounded-3xl',\n        'full' => 'rounded-full'\n    ];\n    return $radius_map[$radius] ?? 'rounded-2xl';\n};\n\n$get_object_fit_class = function($fit) {\n    $fit_map = [\n        'cover' => 'object-cover',\n        'contain' => 'object-contain',\n        'fill' => 'object-fill',\n        'none' => 'object-none',\n        'scale-down' => 'object-scale-down'\n    ];\n    return $fit_map[$fit] ?? 'object-cover';\n};\n\n$get_aspect_ratio_class = function($ratio) {\n    if ($ratio === 'auto') return '';\n    $ratio_map = [\n        '16/9' => 'aspect-video',\n        '4/3' => 'aspect-[4/3]',\n        '3/2' => 'aspect-[3/2]',\n        '21/9' => 'aspect-[21/9]',\n        '1/1' => 'aspect-square'\n    ];\n    return $ratio_map[$ratio] ?? '';\n};\n\n$get_container_padding_class = function($padding) {\n    $padding_map = [\n        'none' => '',\n        'sm' => 'px-4',\n        'md' => 'px-6 md:px-8',\n        'lg' => 'px-8 md:px-12',\n        'xl' => 'px-12 md:px-16 lg:px-20'\n    ];\n    return $padding_map[$padding] ?? '';\n};\n\n// Calculate dynamic classes\n$border_radius_class = $get_border_radius_class($border_radius);\n$object_fit_class = $get_object_fit_class($object_fit);\n$aspect_ratio_class = $get_aspect_ratio_class($aspect_ratio);\n$container_padding_class = $get_container_padding_class($container_padding);\n\n// Build CSS classes\n$wrapper_classes = [\n    'section-wide-image-block',\n    'w-full',\n    'overflow-hidden',\n    $container_padding_class\n];\n\n// Add block attributes classes\nif (!empty($attributes['className'])) {\n    $wrapper_classes[] = $attributes['className'];\n}\n\n$wrapper_class = implode(' ', array_filter($wrapper_classes));\n\n// Build image container classes\n$image_container_classes = [\n    'w-full',\n    'relative'\n];\n\nif (!empty($aspect_ratio_class)) {\n    $image_container_classes[] = $aspect_ratio_class;\n}\n\n$image_container_class = implode(' ', array_filter($image_container_classes));\n\n// Build image classes\n$image_classes = [\n    'w-full',\n    'h-auto',\n    $object_fit_class,\n    $border_radius_class\n];\n\n$image_class = implode(' ', array_filter($image_classes));\n\n// Prepare inline styles\n$image_styles = [];\nif ($max_height !== 'none' && !empty($max_height)) {\n    $image_styles[] = 'max-height: ' . esc_attr($max_height);\n}\n\n$image_style_attr = !empty($image_styles) ? 'style=\"' . implode('; ', $image_styles) . '\"' : '';\n\n// Prepare overlay styles\n$overlay_styles = [];\nif ($overlay_enabled) {\n    $overlay_styles[] = 'position: absolute';\n    $overlay_styles[] = 'top: 0';\n    $overlay_styles[] = 'left: 0';\n    $overlay_styles[] = 'right: 0';\n    $overlay_styles[] = 'bottom: 0';\n    $overlay_styles[] = 'background-color: ' . esc_attr($overlay_color);\n    $overlay_styles[] = 'pointer-events: none';\n}\n\n$overlay_style_attr = !empty($overlay_styles) ? 'style=\"' . implode('; ', $overlay_styles) . '\"' : '';\n\n// Prepare animation attributes\n$animation_attrs = [];\nif ($enable_animation) {\n    $animation_attrs[] = 'data-aos=\"' . esc_attr($animation_type) . '\"';\n    $animation_attrs[] = 'data-aos-duration=\"' . esc_attr($animation_duration) . '\"';\n    if ($animation_delay > 0) {\n        $animation_attrs[] = 'data-aos-delay=\"' . esc_attr($animation_delay) . '\"';\n    }\n    $animation_attrs[] = 'data-aos-easing=\"' . esc_attr($animation_easing) . '\"';\n}\n\n$animation_attr_string = !empty($animation_attrs) ? implode(' ', $animation_attrs) : '';\n\n// Get optimized image if using WordPress media library\n$image_srcset = '';\n$image_sizes = '';\nif ($image_id > 0) {\n    $image_srcset = wp_get_attachment_image_srcset($image_id, 'full');\n    $image_sizes = wp_get_attachment_image_sizes($image_id, 'full');\n    \n    // Get optimized image URL\n    $optimized_image = wp_get_attachment_image_url($image_id, 'full');\n    if ($optimized_image) {\n        $image_url = $optimized_image;\n    }\n}\n\n// Prepare loading attribute\n$loading_attr = $enable_lazy_load ? 'loading=\"lazy\"' : 'loading=\"eager\"';\n\n// Prepare fetchpriority for above-the-fold images\n$fetchpriority_attr = !$enable_lazy_load ? 'fetchpriority=\"high\"' : '';\n\n// Build the image element\n$image_element = sprintf(\n    '<img src=\"%s\" alt=\"%s\" class=\"%s\" width=\"%d\" height=\"%d\" %s %s %s %s />',\n    esc_url($image_url),\n    esc_attr($image_alt),\n    esc_attr($image_class),\n    esc_attr($image_width),\n    esc_attr($image_height),\n    $image_style_attr,\n    $loading_attr,\n    $fetchpriority_attr,\n    $image_srcset ? 'srcset=\"' . esc_attr($image_srcset) . '\"' : ''\n);\n\n// Add sizes attribute if available\nif ($image_sizes) {\n    $image_element = str_replace('/>', 'sizes=\"' . esc_attr($image_sizes) . '\" />', $image_element);\n}\n\n// Wrap image in link if URL is provided\nif (!empty($link_url)) {\n    $link_attrs = [];\n    $link_attrs[] = 'href=\"' . esc_url($link_url) . '\"';\n    $link_attrs[] = 'class=\"block\"';\n    \n    if (!empty($link_target)) {\n        $link_attrs[] = 'target=\"' . esc_attr($link_target) . '\"';\n    }\n    \n    if (!empty($link_rel)) {\n        $link_attrs[] = 'rel=\"' . esc_attr($link_rel) . '\"';\n    }\n    \n    $link_attr_string = implode(' ', $link_attrs);\n    $image_element = sprintf(\n        '<a %s aria-label=\"%s\">%s</a>',\n        $link_attr_string,\n        esc_attr($image_alt),\n        $image_element\n    );\n}\n?>\n\n<div class=\"<?php echo esc_attr($wrapper_class); ?>\"\n     <?php if (!empty($attributes['anchor'])): ?>id=\"<?php echo esc_attr($attributes['anchor']); ?>\"<?php endif; ?>>\n    \n    <div class=\"<?php echo esc_attr($image_container_class); ?>\" <?php echo $animation_attr_string; ?>>\n        <div class=\"relative <?php echo esc_attr($aspect_ratio_class); ?>\">\n            <?php echo $image_element; ?>\n            \n            <?php if ($overlay_enabled): ?>\n                <div class=\"<?php echo esc_attr($border_radius_class); ?>\" <?php echo $overlay_style_attr; ?> aria-hidden=\"true\"></div>\n            <?php endif; ?>\n        </div>\n    </div>\n    \n</div>\n\n<?php\n// Enqueue AOS library if animation is enabled and not already enqueued\nif ($enable_animation && !wp_script_is('aos', 'enqueued')) {\n    // Add inline script to initialize AOS if not already initialized\n    $aos_init_script = \"\n    <script>\n        if (typeof AOS !== 'undefined' && !window.aosInitialized) {\n            AOS.init({\n                duration: 1200,\n                once: true,\n                offset: 100,\n                easing: 'ease-in-out',\n                disable: false,\n                startEvent: 'DOMContentLoaded'\n            });\n            window.aosInitialized = true;\n        }\n    </script>\n    \";\n    \n    // Output the script (will be moved to footer by WordPress)\n    add_action('wp_footer', function() use ($aos_init_script) {\n        echo $aos_init_script;\n    }, 100);\n}\n?>"
}